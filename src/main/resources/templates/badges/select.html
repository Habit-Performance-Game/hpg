<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head th:replace="partials/header :: header('Habit Select')" />
<body>
<nav th:replace="partials/navbar :: navbar"></nav>


<h1>Please select a new habit.</h1>
<div sec:authorize="isAuthenticated()">
</div>



<div class="container">
    <div class="row">
        <div class="col-sm-6">
            <ul class="list-group">
                <div class="" th:each="badge : ${badges}">
                    <li class="list-group-item">
                    <div class="float-left" th:text="${badge.name}"></div>
                        <div class="btn-group" role="group">
                            <i class="fa fa-plus addHabit" aria-hidden="true" th:attr="data-id=${badge.id}"></i>
                        </div>
                    </li>
                </div>
            </ul>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script>

    $(function () {
        var token = $("input[name='_csrf']").val();
        var header = "X-CSRF-TOKEN";
        $(document).ajaxSend(function(e, xhr, options) {
            xhr.setRequestHeader(header, token);
        });
    });

    $(".addHabit").click(function () {
        $.ajax("/habits", {
            type: "POST",
            data: {
                badge_id: $(this).attr('data-id'),
            }
        });
    });



    // $(".addHabit").click(function () {
    //     $.post("/habits", {
    //         token : $("meta[name='_csrf']").attr("content"),
    //         header: $("meta[name='_csrf_header']").attr("content"),
    //         badge_id: $(this).attr('data-id')
    //     }).done(function (data) {
    //         console.log("done");
    //     })
    // })


</script>

</body>
</html>